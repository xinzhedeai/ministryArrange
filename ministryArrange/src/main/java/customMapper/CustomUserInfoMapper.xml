<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="customMapper.CustomUserInfoMapper">
	<select id="checkUser" resultType="Integer">
		select 
			count(user_name)
		from
			user
	    where 
	    	user_name = #{userName} and user_pwd = #{userPwd};
	</select>
	<insert id="insertUser">
		insert into user
		(
		<!-- id, -->
		username,
		pwd,
		tel,
		area,
		church,
		serve_days_pre_forth,
		serve_days_fifth
		)
		values
		(
		<!-- UUID(), -->
		#{username},
		UUID(),
		#{tel},
		#{area},
		#{church},
		#{serve_days_pre_forth},
		#{serve_days_fifth}
		)
	</insert>
	<insert id="insertAddress">
		insert into serviceaddress
		(
		<!-- id, -->
		area,
		church,
		reunion_type
		)
		values
		(
		<!-- UUID(), -->
		#{area},
		#{church},
		#{reunion_type}
		)
	</insert>
	<select id="getUserListByPage"  parameterType="Map" resultType="Map">
		SELECT
			id
			,username
			,pwd
			,tel
			,area
			,church
			,longitude
			,latitude
			,serve_days_pre_forth * 1 as serve_days_pre_forth
			,serve_days_fifth * 1 as serve_days_fifth			
		FROM
			user 
   		<where>
		 	<if test="area != null and area != ''">
			 	and area like '%${area}%'
		 	</if>
		 	<if test="church != null and church != ''">
			 	and church like '%${church}%'
		 	</if>
		 	<if test="serve_days_pre_forth != null and serve_days_pre_forth != ''">
			 	and serve_days_pre_forth = #{serve_days_pre_forth}
		 	</if>
		 	<if test="serve_days_fifth != null and serve_days_fifth != ''">
			 	and serve_days_fifth like  = #{serve_days_fifth}
		 	</if>
	 	</where>	
	 </select>
</mapper>